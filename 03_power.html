<!DOCTYPE html>
<html>
<head>
  <title>Анализ мощности</title>

  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="generator" content="pandoc" />




  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">

  <link rel="stylesheet" media="all" href="site_libs/ioslides-13.5.1/fonts/fonts.css">

  <link rel="stylesheet" media="all" href="site_libs/ioslides-13.5.1/theme/css/default.css">
  <link rel="stylesheet" media="only screen and (max-device-width: 480px)" href="site_libs/ioslides-13.5.1/theme/css/phone.css">

  <base target="_blank">

  <script type="text/javascript">
    var SLIDE_CONFIG = {
      // Slide settings
      settings: {
                title: 'Анализ мощности',
                        subtitle: 'Линейные модели, дисперсионный и регрессионный анализ на R, осень 2015',
                useBuilds: true,
        usePrettify: true,
        enableSlideAreas: true,
        enableTouch: true,
                      },

      // Author information
      presenters: [
            {
        name:  'Марина Варфоломеева' ,
        company: '',
        gplus: '',
        twitter: '',
        www: '',
        github: ''
      },
            ]
    };
  </script>

  <style type="text/css">

    b, strong {
      font-weight: bold;
    }

    em {
      font-style: italic;
    }

    slides > slide {
      -webkit-transition: all 0.4s ease-in-out;
      -moz-transition: all 0.4s ease-in-out;
      -o-transition: all 0.4s ease-in-out;
      transition: all 0.4s ease-in-out;
    }

    .auto-fadein {
      -webkit-transition: opacity 0.6s ease-in;
      -webkit-transition-delay: 0.4s;
      -moz-transition: opacity 0.6s ease-in 0.4s;
      -o-transition: opacity 0.6s ease-in 0.4s;
      transition: opacity 0.6s ease-in 0.4s;
      opacity: 0;
    }

  </style>

  <link rel="stylesheet" href="my_styles.css" type="text/css" />

</head>

<body style="opacity: 0">

<slides class="layout-widescreen">

  <slide class="title-slide segue nobackground">
        <!-- The content of this hgroup is replaced programmatically through the slide_config.json. -->
    <hgroup class="auto-fadein">
      <h1 data-config-title><!-- populated from slide_config.json --></h1>
      <h2 data-config-subtitle><!-- populated from slide_config.json --></h2>
      <p data-config-presenter><!-- populated from slide_config.json --></p>
          </hgroup>
  </slide>

<slide class=''><hgroup><h2>Экономим силы с помощью анализа мощности</h2></hgroup><article  id="-----">

<ul>
<li>Статистические ошибки при проверке гипотез</li>
<li>Мощность статистического теста</li>
<li><em>A priori</em> анализ мощности, оценка величины эффекта</li>
<li><em>Post hoc</em> анализ мощности</li>
<li>Как влиять на мощность тестов</li>
</ul>

</article></slide><slide class=''><hgroup><h2>Вы сможете</h2></hgroup><article  id="-">

<ul>
<li>дать определение ошибок I и II рода, и графически изобразить их отношение к мощности теста</li>
<li>оценивать величину эффекта и необходимый объем выборки по данным пилотного исследования</li>
<li>загружать данные из .xls в R</li>
<li>строить гистограммы и боксплоты с помощью <code>ggplot2</code></li>
<li>сравнивать средние значения при помощи t-критерия, интерпретировать и описывать результаты</li>
<li>расчитывать фактическую мощность теста</li>
</ul>

</article></slide><slide class='segue dark nobackground level1'><hgroup class = 'auto-fadein'><h2>Статистические ошибки при проверке гипотез</h2></hgroup><article  id="----">

</article></slide><slide class=''><hgroup><h2>Типы ошибок при проверке гипотез</h2></hgroup><article  id="----">

<table class = 'rmdtable'>
<col width="8%" />
<col width="8%" />
<col width="8%" />
<tr class="header">
<th align="left"></th>
<th align="left">H0 == TRUE</th>
<th align="left">H0 == FALSE</th>
</tr>
<tr class="odd">
<td align="left">Отклонить H0</td>
<td align="left">Ошибка I рода </br>Ложно-положительный результат</td>
<td align="left">Верно </br>Положительный результат</td>
</tr>
<tr class="even">
<td align="left">Сохранить H0</td>
<td align="left">Верно </br>Отрицательный результат</td>
<td align="left">Ошибка II рода </br> Ложно-отрицательный результат</td>
</tr>
</table>

<h3>Вероятности гипотез</h3>

<p><img src="03_power_analysis_files/figure-html/power_curves-1.png" width="672" style="display: block; margin: auto;" /></p>

</article></slide><slide class=''><hgroup><h2>Типы ошибок при проверке гипотез</h2></hgroup><article  id="-----1">

<table class = 'rmdtable'>
<col width="8%" />
<col width="8%" />
<col width="8%" />
<tr class="header">
<th align="left"></th>
<th align="left">H0 == TRUE</th>
<th align="left">H0 == FALSE</th>
</tr>
<tr class="odd">
<td align="left">Отклонить H0</td>
<td align="left">Ошибка I рода </br>Ложно-положительный результат</td>
<td align="left">Верно </br>Положительный результат</td>
</tr>
<tr class="even">
<td align="left">Сохранить H0</td>
<td align="left">Верно </br>Отрицательный результат</td>
<td align="left">Ошибка II рода </br> Ложно-отрицательный результат</td>
</tr>
</table>

<h3>Ошибки I рода</h3>

<p><img src="03_power_analysis_files/figure-html/power_alpha-1.png" width="672" style="display: block; margin: auto;" /></p>

</article></slide><slide class=''><hgroup><h2>Типы ошибок при проверке гипотез</h2></hgroup><article  id="-----2">

<table class = 'rmdtable'>
<col width="8%" />
<col width="8%" />
<col width="8%" />
<tr class="header">
<th align="left"></th>
<th align="left">H0 == TRUE</th>
<th align="left">H0 == FALSE</th>
</tr>
<tr class="odd">
<td align="left">Отклонить H0</td>
<td align="left">Ошибка I рода </br>Ложно-положительный результат</td>
<td align="left">Верно </br>Положительный результат</td>
</tr>
<tr class="even">
<td align="left">Сохранить H0</td>
<td align="left">Верно </br>Отрицательный результат</td>
<td align="left">Ошибка II рода </br> Ложно-отрицательный результат</td>
</tr>
</table>

<h3>Ошибки II рода</h3>

<p><img src="03_power_analysis_files/figure-html/power_beta-1.png" width="672" style="display: block; margin: auto;" /></p>

</article></slide><slide class=''><hgroup><h2>Типы ошибок при проверке гипотез</h2></hgroup><article  id="-----3">

<table class = 'rmdtable'>
<col width="8%" />
<col width="8%" />
<col width="8%" />
<tr class="header">
<th align="left"></th>
<th align="left">H0 == TRUE</th>
<th align="left">H0 == FALSE</th>
</tr>
<tr class="odd">
<td align="left">Отклонить H0</td>
<td align="left">Ошибка I рода </br>Ложно-положительный результат</td>
<td align="left">Верно </br>Положительный результат</td>
</tr>
<tr class="even">
<td align="left">Сохранить H0</td>
<td align="left">Верно </br>Отрицательный результат</td>
<td align="left">Ошибка II рода </br> Ложно-отрицательный результат</td>
</tr>
</table>

<h3>Мощность теста - способность выявлять различия \(Power = 1 - \beta\)</h3>

<p><img src="03_power_analysis_files/figure-html/unnamed-chunk-1-1.png" width="969.6" style="display: block; margin: auto;" /></p>

</article></slide><slide class=''><hgroup><h2>Анализ мощности</h2></hgroup><article  id="-">

<div class="columns-2">
<center>

<em>A priori</em>

</center>

<ul>
<li>какой нужен объем выборки, чтобы найти различия с разумной долей уверенности?</li>
<li>различия какой величины мы можем найти, если известен объем выборки?</li>
</ul>

<center>

<em>Post hoc</em>

</center>

<ul>
<li>смогли бы мы найти различия при помощи нашего эксперимента (\(\alpha\), \(n\)), если бы величина эффекта была \(X\)?</li>
</ul>

<p></br></p></div>

</article></slide><slide class='segue dark nobackground level1'><hgroup class = 'auto-fadein'><h2>A priory анализ мощности</h2></hgroup><article  id="a-priory--">

</article></slide><slide class=''><hgroup><h2>Пример: Заповедник спасает халиотисов*</h2></hgroup><article  id="---">

<div class="floatright" style="float:right; margin: 0 0 10px 10px; padding: 10px; ">
<img src="images/Haliotis_rubra.jpeg" alt="Haliotis rubra"  style="float:right; margin:0 5px 0 0;"/>

<p style="margin-top: 0; margin-bottom: 0; text-align: center;">

<em>Haliotis rubra</em>

</p></div>

<p>Лов халиотисов (коммерческий и любительский) запретили, организовав заповедник.</p>

<p>Стало ли больше моллюсков через несколько лет? (Keough, King, 1991)</p>

<div class = "footnote">

<ul>
<li><ul>
<li>Данные из Quinn, Keough, 2002, Box 9-5, Fig 9-7; фото: Des Beechey - Seashells of New South Wales; bie.ala.org.au

</div></li>
</ul></li>
</ul>

</article></slide><slide class=''><hgroup><h2>A priori анализ мощности</h2></hgroup><article  id="a-priori--">

<div class="columns-2">
<p>Что нужно</p>

<ul>
<li><p>тест</p></li>
<li><p>уровень значимости</p></li>
<li><p>желаемая мощность теста</p></li>
<li><p>ожидаемая величина эффекта</p></li>
</ul>

<p></br> </br> - \(t\)-критерий</p>

<ul>
<li><p>\(alpha = 0.05\)</p></li>
<li><p>P = 80%</p></li>
<li><p>?</p></li>
</ul></div>

</article></slide><slide class=''><hgroup><h2>Величина эффекта</h2></hgroup><article  id="-">

<div class="floatright" style="float:right; margin: 0 0 10px 10px; padding: 10px; ">
<img src="images/Jacob%20Cohen.jpg" alt="Яков Коэн"  style="float:right; margin:0 5px 0 0;"/>

<p style="margin-top: 0; margin-bottom: 0; text-align: center;">

Яков Коэн

</p></div>

<p>\(d\) Коэна (Cohen&#39;s d)</p>

<p><br /> \[d = \frac{\bar \mu_1 - \bar \mu_2}{\sigma}\]</p>

</article></slide><slide class=''><hgroup><h2>Как оценить стандартное отклонение для расчета величины эффекта?</h2></hgroup><article  id="-------">

<p>\[d = \frac{\bar \mu_1 - \bar \mu_2}{\sigma}\]</p>

<ul>
<li>как среднеквадратичное стандартное отклонение (\(d\) Коэна)</li>
</ul>

<p>\(d = \frac {|\bar x_1 - \bar x_2|} { \sqrt {\frac {s_1^2 + s_2^2 } {2} }}\)</p>

<ul>
<li>как обобщенное стандартное отклонение (\(g\) Хеджа)</li>
</ul>

<p>\(g = \frac {|\bar x _{1} - \bar x _{2}|} { \sqrt {\frac {(n_{1} - 1) s_1^2 + (n_{2} - 1) s_{2}^2 } {n_{1} + n_{2} - 2} } }\)</p>

</article></slide><slide class=''><hgroup><h2>Как оценить ожидаемую величину эффекта?</h2></hgroup><article  id="----">

<p>\[d = \frac{\bar \mu_1 - \bar \mu_2}{\sigma}\]</p>

<ul class = 'build'>
<li>Варианты:</li>
<li>Пилотные исследования</li>
<li>Литература</li>
<li>Общебиологические знания</li>
<li>Технические требования</li>
</ul>

</article></slide><slide class=''><hgroup><h2>Величина эффекта из общих соображений</h2></hgroup><article  id="----">

<p>(Cohen, 1982)</p>

<p>сильные, умеренные и слабые эффекты</p>

<pre class = 'prettyprint lang-r'>library(pwr)
cohen.ES(test = &quot;t&quot;, size = &quot;large&quot;)</pre>

<pre >## 
##      Conventional effect size from Cohen (1982) 
## 
##            test = t
##            size = large
##     effect.size = 0.8</pre>

</article></slide><slide class=''><hgroup><h2>Рассчитайте</h2></hgroup><article >

<p>величину умеренных и слабых эффектов для t-критерия</p>

<pre class = 'prettyprint lang-r'>    library()
    cohen.ES()</pre>

<p>Подсказка: обозначения можно посмотреть в файлах справки</p>

<pre class = 'prettyprint lang-r'>    help(cohen.ES)
    ?cohen.ES
    cohen.ES # курсор на слове, нажать F1</pre>

</article></slide><slide class=''><hgroup><h2>Величина эффекта из пилотных данных</h2></hgroup><article  id="----">

<p>\[d = \frac{\bar \mu_1 - \bar \mu_2}{\sigma}\]</p>

<p>\({\sigma}\) - cтандартное отклонение плотности халиотисов:</p>

<ul class = 'build'>
<li>Плотность крупных халиотисов на \(50 м^2\) была \(\bar x = 47.5\), \(SD = 27.7\)</li>
</ul>

<p>\({\bar \mu_1 - \bar \mu_2}\) - cредний вылов халиотисов в год:</p>

<ul class = 'build'>
<li>Масса выловленных коммерческим способом + данные о размерах -&gt; численность -&gt; плотность</li>
<li>Предположили, что коммерческий лов и любительский лов равны</li>
<li>Коммерческий лов = 11.6 экз. \(м^{-2}\)</li>
<li>Коммерческий + любительский лов = 23.2 экз. \(м^{-2}\)</li>
</ul>

</article></slide><slide class=''><hgroup><h2>Данные для анализа мощности собраны</h2></hgroup><article  id="----">

<pre class = 'prettyprint lang-r'>alpha &lt;- 0.05
power &lt;- 0.80
sigma &lt;- 27.7 # варьирование плотности халиотисов
diff &lt;- 23.2 # ожидаемые различия плотности халиотисов
effect &lt;- diff/sigma # величина эффекта
effect</pre>

<pre >## [1] 0.838</pre>

</article></slide><slide class=''><hgroup><h2>Функции для анализа мощности t-критерия</h2></hgroup><article  id="----t-">

<ul>
<li>при одинаковых объемах групп <code>pwr.t.test()</code></li>
<li>при разных объемах групп <code>pwr.t2n.test()</code></li>
</ul>

</article></slide><slide class=''><hgroup><h2>Считаем объем выборки</h2></hgroup><article  id="--">

<pre class = 'prettyprint lang-r'>pwr.t.test(n = NULL, d = effect, power = power, sig.level = alpha,
           type = &quot;two.sample&quot;, alternative = &quot;two.sided&quot;)</pre>

<pre >## 
##      Two-sample t test power calculation 
## 
##               n = 23.4
##               d = 0.838
##       sig.level = 0.05
##           power = 0.8
##     alternative = two.sided
## 
## NOTE: n is number in *each* group</pre>

<ul class = 'build'>
<li>Чтобы с вероятностью 0.8 выявить различия плотности халиотисов в местах, где лов разрешен и запрещен, нужно обследовать <strong>по 24 места каждого типа</strong>, если мы верно оценили величину эффекта.</li>
</ul>

</article></slide><slide class=''><hgroup><h2>Рассчитайте</h2></hgroup><article  id="-1">

<p>сколько нужно обследовать мест, чтобы обнаружить слабый эффект с вероятностью 0.8, при уровне значимости 0.01</p>

<pre class = 'prettyprint lang-r'>    cohen.ES()
    pwr.t.test()</pre>

</article></slide><slide class=''><hgroup><h2>Решение</h2></hgroup><article >

<pre class = 'prettyprint lang-r'>cohen.ES(test = &quot;t&quot;, size = &quot;small&quot;)</pre>

<pre >## 
##      Conventional effect size from Cohen (1982) 
## 
##            test = t
##            size = small
##     effect.size = 0.2</pre>

<pre class = 'prettyprint lang-r'>pwr.t.test(n = NULL, d = 0.2, power = 0.8, sig.level = 0.01,
           type = &quot;two.sample&quot;, alternative = &quot;two.sided&quot;)</pre>

<pre >## 
##      Two-sample t test power calculation 
## 
##               n = 586
##               d = 0.2
##       sig.level = 0.01
##           power = 0.8
##     alternative = two.sided
## 
## NOTE: n is number in *each* group</pre>

</article></slide><slide class=''><hgroup><h2>Пример: Поддержание равновесия</h2></hgroup><article  id="--">

<div class="floatright" style="float:right; margin: 0 0 10px 10px; padding: 10px; ">
<img src="images/grey-bird-by-Angela-Vincent%20on%20Flickr.jpg" alt="Balance"  style="float:right; margin:0 5px 0 0;"/>

<p style="margin-top: 0; margin-bottom: 0; text-align: center;">

grey bird

</p></div>

<p>В каком возрасте сложнее поддерживать равновесие, если вы сосредоточены на чем-то другом?</p>

<p>9 пожилых людей (6 мужчин и 3 женщины) и 8 молодых мужчин просили стоять на измерительной платформе. В ответ на неожиданный звук испытуемые должны были как можно быстрее нажать на кнопку. Платформа измеряла в мм насколько человек отклонялся вбок или вперед-назад.</p>

<div class = "footnote">

<ul>
<li><a href='http://lib.stat.cmu.edu/DASL/Stories/MaintainingBalance.html' title=''>http://lib.stat.cmu.edu/DASL/Stories/MaintainingBalance.html</a>; фото: grey bird by Angela Vincent on Flickr

</div></li>
</ul>

</article></slide><slide class=''><hgroup><h2>Читаем данные из файла</h2></hgroup><article  id="---">

<p>Не забудте войти в вашу директорию для матметодов, например, так</p>

<pre class = 'prettyprint lang-r'># setwd(&quot;C:/Мои\ документы/mathmethR/) # в Windows
# setwd(/home/yourusername/mathmethR/) # в Linux
library(readxl)
bal &lt;- read_excel(path = &quot;data/balance.xlsx&quot;, sheet = 1)</pre>

<pre class = 'prettyprint lang-r'>str(bal) # Структура данных</pre>

<pre >## Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:    17 obs. of  4 variables:
##  $ subject_no      : num  1 2 3 4 5 6 7 8 9 1 ...
##  $ forward_backward: num  19 30 20 19 29 25 21 24 50 25 ...
##  $ side_side       : num  14 41 18 11 16 24 18 21 37 17 ...
##  $ age_group       : chr  &quot;elderly&quot; &quot;elderly&quot; &quot;elderly&quot; &quot;elderly&quot; ...</pre>

</article></slide><slide class=''><hgroup><h2>Вспомним, как обращаться с датафреймами</h2></hgroup><article  id="----">

<pre class = 'prettyprint lang-r'>head(bal)     # Первые несколько строк файла</pre>

<pre >## # A tibble: 6 × 4
##   subject_no forward_backward side_side age_group
##        &lt;dbl&gt;            &lt;dbl&gt;     &lt;dbl&gt;     &lt;chr&gt;
## 1          1               19        14   elderly
## 2          2               30        41   elderly
## 3          3               20        18   elderly
## 4          4               19        11   elderly
## 5          5               29        16   elderly
## 6          6               25        24   elderly</pre>

<pre class = 'prettyprint lang-r'>bal$side_side[1:3] # Первые три значения переменной side_side</pre>

<pre >## [1] 14 41 18</pre>

<pre class = 'prettyprint lang-r'>bal[12:14, c(1, 2, 4)] # 12-14 строки, 1, 2 и 4 столбцы</pre>

<pre >## # A tibble: 3 × 3
##   subject_no forward_backward age_group
##        &lt;dbl&gt;            &lt;dbl&gt;     &lt;chr&gt;
## 1          3               17     young
## 2          4               15     young
## 3          5               14     young</pre>

</article></slide><slide class=''><hgroup><h2>Сделаем age_group фактором</h2></hgroup><article  id="-age_group-">

<pre class = 'prettyprint lang-r'>bal$age_group &lt;- factor(bal$age_group, levels = c(&quot;young&quot;, &quot;elderly&quot;), 
    labels = c(&quot;молодые&quot;, &quot;пожилые&quot;))</pre>

<p>Посмотреть, что получилось, можно так</p>

<pre class = 'prettyprint lang-r'>levels(bal$age_group)</pre>

<pre >## [1] &quot;молодые&quot; &quot;пожилые&quot;</pre>

</article></slide><slide class=''><hgroup><h2>Бокс-плот</h2></hgroup><article  id="-">

<p>Геом <code>geom_boxplot</code></p>

<pre class = 'prettyprint lang-r'>library(ggplot2)
ggplot(data = bal, aes(x = age_group, y = forward_backward)) + 
  geom_boxplot()</pre>

<p><img src="03_power_analysis_files/figure-html/unnamed-chunk-14-1.png" width="672" style="display: block; margin: auto;" /></p>

<ul class = 'build'>
<li>Установите до конца сеанса другую тему</li>
</ul>

</article></slide><slide class=''><hgroup><h2>Решение</h2></hgroup><article  id="-1">

<pre class = 'prettyprint lang-r'>theme_set(theme_bw())
ggplot(data = bal, aes(x = age_group, y = forward_backward)) + geom_boxplot()</pre>

<p><img src="03_power_analysis_files/figure-html/unnamed-chunk-16-1.png" width="672" style="display: block; margin: auto;" /></p>

</article></slide><slide class=''><hgroup><h2>Раскрашиваем график</h2></hgroup><article  id="-">

<p>эстетика <code>fill</code> - заливка эстетика <code>colour</code> - контуры</p>

<pre class = 'prettyprint lang-r'>ggplot(data = bal, aes(x = age_group, y = forward_backward, fill = age_group)) + 
    geom_boxplot()

ggplot(data = bal, aes(x = age_group, y = forward_backward, colour = age_group)) + 
    geom_boxplot()</pre>

<p><img src="03_power_analysis_files/figure-html/unnamed-chunk-18-1.png" width="960" style="display: block; margin: auto;" /></p>

</article></slide><slide class=''><hgroup><h2>Задание</h2></hgroup><article >

<p>Добавьте - подписи осей - название графика - название легенды</p>

<p>Сохраните график в переменной</p>

</article></slide><slide class=''><hgroup><h2>Решение</h2></hgroup><article  id="-2">

<pre class = 'prettyprint lang-r'>gg_balance &lt;- ggplot(data = bal, aes(x = age_group, y = forward_backward)) + 
    geom_boxplot(aes(fill = age_group)) + labs(title = &quot;Баланс тела&quot;, 
    x = &quot;Возрастная группа&quot;, y = &quot;Движение \nвперед-назад (мм)&quot;, 
    fill = &quot;Возрастная \nгруппа&quot;)
gg_balance</pre>

<p><img src="03_power_analysis_files/figure-html/unnamed-chunk-19-1.png" width="672" style="display: block; margin: auto;" /></p>

</article></slide><slide class='segue dark nobackground level1'><hgroup class = 'auto-fadein'><h2>A priory анализ мощности по данным пилотного исследования</h2></hgroup><article  id="a-priory------">

</article></slide><slide class=''><hgroup><h2>Представим, что перед нами данные пилотного исследования</h2></hgroup><article  id="------">

<p>Мы хотим сравнить возрастные группы</p>

<p>Нам нужно рассчитать величину эффекта по исходным данным. Для этого понадобится пакет <code>effsize</code></p>

</article></slide><slide class=''><hgroup><h2>Величина эффекта по исходным данным</h2></hgroup><article  id="----">

<pre class = 'prettyprint lang-r'>library(effsize)
effect &lt;- cohen.d(bal$forward_backward, bal$age_group)
effect</pre>

<pre >## 
## Cohen&#39;s d
## 
## d estimate: -1.07 (large)
## 95 percent confidence interval:
##    inf    sup 
## -2.260  0.117</pre>

<ul class = 'build'>
<li>как добыть значение величины эффекта?</li>
</ul>

</article></slide><slide class=''><hgroup><h2>Как добыть значение величины эффекта?</h2></hgroup><article  id="----">

<h3>1. Как называется в структуре объекта элемент, где записана величина эффекта?</h3>

<pre class = 'prettyprint lang-r'>str(effect)</pre>

<pre >## List of 6
##  $ method    : chr &quot;Cohen&#39;s d&quot;
##  $ name      : chr &quot;d&quot;
##  $ estimate  : Named num -1.07
##   ..- attr(*, &quot;names&quot;)= chr &quot;молодые&quot;
##  $ conf.int  : Named num [1:2] -2.26 0.117
##   ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;inf&quot; &quot;sup&quot;
##  $ conf.level: num 0.95
##  $ magnitude : Ord.factor w/ 4 levels &quot;negligible&quot;&lt;&quot;small&quot;&lt;..: 4
##  - attr(*, &quot;class&quot;)= chr &quot;effsize&quot;</pre>

</article></slide><slide class=''><hgroup><h2>Как добыть значение величины эффекта?</h2></hgroup><article  id="-----1">

<h3>2. Обращаемся к этому элементу по имени через <code>$</code></h3>

<pre class = 'prettyprint lang-r'>effect$estimate</pre>

<pre >## молодые 
##   -1.07</pre>

<h3>3. Вычислим модуль, поскольку для pwr.t.test() эффект должен быть положительным</h3>

<pre class = 'prettyprint lang-r'>effect &lt;- abs(effect$estimate)</pre>

</article></slide><slide class=''><hgroup><h2>Рассчитайте</h2></hgroup><article  id="-2">

<p>объем выборки, чтобы показать различия между группами с вероятностью 0.8?</p>

<p>Вам понадобится функция <code>pwr.t.test</code></p>

</article></slide><slide class=''><hgroup><h2>Решение</h2></hgroup><article  id="-3">

<pre class = 'prettyprint lang-r'>library(pwr)
pwr.t.test(n = NULL, d = effect, power = 0.8, sig.level = 0.05, 
           type = &quot;two.sample&quot;, alternative = &quot;two.sided&quot;)</pre>

<pre >## 
##      Two-sample t test power calculation 
## 
##               n = 14.7
##               d = 1.07
##       sig.level = 0.05
##           power = 0.8
##     alternative = two.sided
## 
## NOTE: n is number in *each* group</pre>

<ul class = 'build'>
<li>Нужна выборка <strong>15 человек в каждой группе</strong>, чтобы с вероятностью 0.8 обнаружить различия амплитуды качания вперед-назад.</li>
</ul>

</article></slide><slide class='segue dark nobackground level1'><hgroup class = 'auto-fadein'><h2>Post hoc анализ мощности</h2></hgroup><article  id="post-hoc--">

</article></slide><slide class=''><hgroup><h2>Пример: Влияние витамина C на рост зубов у морских свинок</h2></hgroup><article  id="---c------">

<div class="floatright" style="float:right; margin: 0 0 10px 10px; padding: 10px; ">
<img src="images/guinea-pig.jpg" alt="Guinea pig"  style="float:right; margin:0 5px 0 0;"/>

<p style="margin-top: 0; margin-bottom: 0; text-align: center;">

</p></div>

<p>20 морским свинкам давали витамин С в виде апельсинового сока или аскорбиновой кислоты и измеряли рост зубов.</p>

<div class = "footnote">

<ul>
<li>фрагмент данных из McNeil, D. R. (1977) Interactive Data Analysis. New York: Wiley; фото: www.ag.ndsu.edu

</div></li>
</ul>

</article></slide><slide class=''><hgroup><h2>Открываем данные</h2></hgroup><article  id="-">

<pre class = 'prettyprint lang-r'>teeth &lt;- read_excel(&quot;data/teeth.xlsx&quot;, sheet = 1)
str(teeth)</pre>

<pre >## Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:    20 obs. of  3 variables:
##  $ len : num  23.6 18.5 33.9 25.5 26.4 32.5 26.7 21.5 23.3 29.5 ...
##  $ supp: chr  &quot;VC&quot; &quot;VC&quot; &quot;VC&quot; &quot;VC&quot; ...
##  $ dose: num  2 2 2 2 2 2 2 2 2 2 ...</pre>

</article></slide><slide class=''><hgroup><h2>Задание</h2></hgroup><article  id="-1">

<p>Проверьте при помощи t-критерия будет ли различаться размер зубов при разных способах употребления</p>

</article></slide><slide class=''><hgroup><h2>Решение</h2></hgroup><article  id="-4">

<pre class = 'prettyprint lang-r'>t.test(len ~ supp, data = teeth)</pre>

<pre >## 
##  Welch Two Sample t-test
## 
## data:  len by supp
## t = -0.05, df = 10, p-value = 1
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -3.80  3.64
## sample estimates:
## mean in group OJ mean in group VC 
##             26.1             26.1</pre>

<ul class = 'build'>
<li>Достоверных различий размеров зубов не обнаружено (t-критерий, p &gt; 0.05)</li>
</ul>

</article></slide><slide class=''><hgroup><h2>Post hoc анализ - когда различий не нашли</h2></hgroup><article  id="post-hoc-------">

<p>Какова была реальная величина эффекта?</p>

<p>Хватило ли нам мощности, чтобы выявлять такие незначительные различия?</p>

<h3>Для post hoc анализа нужно знать</h3>

<ul>
<li>тест (\(H _0\) отвергнута!) — t-критерий</li>
<li>уровень значимости — α = 0.01</li>
<li>фактический объем выборки — 10</li>
<li>фактическая величина эффекта — ?</li>
<li>реальная мощность теста - ?</li>
</ul>

</article></slide><slide class=''><hgroup><h2>Сделаем post hoc анализ мощности</h2></hgroup><article  id="-post-hoc--">

<pre class = 'prettyprint lang-r'>effect_real &lt;- cohen.d(teeth$len, teeth$supp)
effect_real &lt;- abs(effect_real$estimate)
pwr.t.test(n = 10, d = effect_real,
           power = NULL, sig.level = 0.01,
           type = &quot;two.sample&quot;,
           alternative = &quot;two.sided&quot;)</pre>

<pre >## 
##      Two-sample t test power calculation 
## 
##               n = 10
##               d = 0.0206
##       sig.level = 0.01
##           power = 0.0101
##     alternative = two.sided
## 
## NOTE: n is number in *each* group</pre>

<ul class = 'build'>
<li>Для выявления слабых эффектов (d = 0.02) мощность оказалась недостаточной (P = 0.01)</li>
</ul>

</article></slide><slide class='segue dark nobackground level1'><hgroup class = 'auto-fadein'><h2>Как влиять на мощность теста?</h2></hgroup><article  id="----">

</article></slide><slide class=''><hgroup><h2>Мощность зависит</h2></hgroup><article  id="-">

<ul>
<li>от объема выборки</li>
<li>от величины эффекта</li>
<li>от уровня значимости</li>
</ul>

</article></slide><slide class=''><hgroup><h2>Чем больше объем выборки—тем больше мощность</h2></hgroup><article  id="-----">

<p><img src="03_power_analysis_files/figure-html/pwr_vs_n-1.png" width="960" style="display: block; margin: auto;" /></p>

</article></slide><slide class=''><hgroup><h2>Чем больше уровень значимости—тем больше мощность</h2></hgroup><article  id="-----">

<p><img src="03_power_analysis_files/figure-html/unnamed-chunk-28-1.png" width="960" style="display: block; margin: auto;" /></p>

</article></slide><slide class=''><hgroup><h2>Чем больше величина различий—тем больше мощность</h2></hgroup><article  id="-----">

<p><img src="03_power_analysis_files/figure-html/unnamed-chunk-29-1.png" width="960" style="display: block; margin: auto;" /></p>

</article></slide><slide class=''><hgroup><h2>Скажите</h2></hgroup><article >

<p>Какие из факторов, влияющих на мощность теста, мы <strong>не можем</strong> контролировать?</p>

<ul class = 'build'>
<li>Мы не можем контролировать внешние факторы</li>
<li>величину эффекта (\(ES\))</li>
<li>фоновую изменчивость (\(\sigma^2\))</li>
</ul>

<p>Каким образом можно повлиять на мощность теста?</p>

<ul class = 'build'>
<li>Мощность теста можно регулировать, если</li>
<li>изменить число повторностей</li>
<li>выбрать другой уровень значимости (\(\alpha\))</li>
<li>определиться, какие эффекты действительно важны (\(ES\))</li>
</ul>

</article></slide><slide class=''><hgroup><h2>Take home messages</h2></hgroup><article  id="take-home-messages">

<ul class = 'build'>
<li>Контролируем статистические ошибки:</li>
<li>чтобы не находить несуществующих эффектов, фиксируем уровень значимости</li>
<li>чтобы не пропустить значимое, рассчитываем величину эффекта, объем выборки и мощность теста</li>
<li>когда не обнаружили достоверных эффектов, оцениваем величину эффекта и мощность теста</li>
</ul>

<ul class = 'build'>
<li>Способность выявлять различия зависит</li>
<li>от объема выборки,</li>
<li>от уровня значимости</li>
<li>от величины эффекта</li>
</ul>

</article></slide><slide class=''><hgroup><h2>Дополнительные ресурсы</h2></hgroup><article  id="-">

<ul>
<li>Quinn, Keough, 2002, pp. 164-170</li>
<li>Open Intro to Statistics: <a href='http://www.openintro.org/stat/down/oiStat2_04.pdf' title=''>4.6 Sample Size and Power</a>, pp. 193-197</li>
<li>Sokal, Rohlf, 1995, pp. 167-169.</li>
<li>Zar, 1999, p. 83.</li>
<li><a href='http://www.ats.ucla.edu/stat/r/dae/t_test_power2.htm' title=''>R Data Analysis Examples - Power Analysis for Two-group Independent sample t-test. UCLA: Statistical Consulting Group.</a></li>
<li><a href='http://www.ats.ucla.edu/stat/r/dae/t_test_power.htm' title=''>R Data Analysis Examples - Power Analysis for One-sample t-test. UCLA: Statistical Consulting Group.</a></li>
<li><a href='http://www.ats.ucla.edu/stat/mult_pkg/faq/general/effect_size_power/effect_size_power.htm' title=''>FAQ - How is effect size used in power analysis? UCLA: Statistical Consulting Group.</a></li>
</ul></article></slide>


  <slide class="backdrop"></slide>

</slides>

<script src="site_libs/ioslides-13.5.1/js/modernizr.custom.45394.js"></script>
<script src="site_libs/ioslides-13.5.1/js/prettify/prettify.js"></script>
<script src="site_libs/ioslides-13.5.1/js/prettify/lang-r.js"></script>
<script src="site_libs/ioslides-13.5.1/js/prettify/lang-yaml.js"></script>
<script src="site_libs/ioslides-13.5.1/js/hammer.js"></script>
<script src="site_libs/ioslides-13.5.1/js/slide-controller.js"></script>
<script src="site_libs/ioslides-13.5.1/js/slide-deck.js"></script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!-- map slide visiblity events into shiny -->
<script>
  (function() {
    if (window.jQuery) {
       window.jQuery(document).on('slideleave', function(e) {
         window.jQuery(e.target).trigger('hidden');
      });
       window.jQuery(document).on('slideenter', function(e) {
         window.jQuery(e.target).trigger('shown');
      });
    }
  })();
</script>

</body>
</html>
