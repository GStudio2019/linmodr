<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Вадим Хайтов, Марина Варфоломеева" />


<title>Обобщенные линейные модели с бинарным откликом</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/simplex.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; } /* Alert */
code span.an { color: #008000; } /* Annotation */
code span.at { } /* Attribute */
code span.bu { } /* BuiltIn */
code span.cf { color: #0000ff; } /* ControlFlow */
code span.ch { color: #008080; } /* Char */
code span.cn { } /* Constant */
code span.co { color: #008000; } /* Comment */
code span.cv { color: #008000; } /* CommentVar */
code span.do { color: #008000; } /* Documentation */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.im { } /* Import */
code span.in { color: #008000; } /* Information */
code span.kw { color: #0000ff; } /* Keyword */
code span.op { } /* Operator */
code span.ot { color: #ff4000; } /* Other */
code span.pp { color: #ff4000; } /* Preprocessor */
code span.sc { color: #008080; } /* SpecialChar */
code span.ss { color: #008080; } /* SpecialString */
code span.st { color: #008080; } /* String */
code span.va { } /* Variable */
code span.vs { color: #008080; } /* VerbatimString */
code span.wa { color: #008000; font-weight: bold; } /* Warning */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="my_styles.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 41px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 46px;
  margin-top: -46px;
}

.section h2 {
  padding-top: 46px;
  margin-top: -46px;
}
.section h3 {
  padding-top: 46px;
  margin-top: -46px;
}
.section h4 {
  padding-top: 46px;
  margin-top: -46px;
}
.section h5 {
  padding-top: 46px;
  margin-top: -46px;
}
.section h6 {
  padding-top: 46px;
  margin-top: -46px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/linmodr/">linmodr</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li><a href="index.html">О курсе</a></li>
        <li><a href="lectures.html">Презентации и данные</a></li>
        <li class="dropdown">
          <a href="appendix" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Полезности<span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu">
             <li><a href="supplement.html">Дополнительные темы</a></li>
             <li><a href="resources.html">Ссылки и ресурсы</a></li>
             <li><a href="coding_practices.html">Правила хорошего кода</a></li>
          </ul>
        </li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Обобщенные линейные модели с бинарным откликом</h1>
<h3 class="subtitle"><em>Линейные модели…</em></h3>
<h4 class="author"><em>Вадим Хайтов, Марина Варфоломеева</em></h4>

</div>


<div id="---" class="section level1">
<h1>Бинарные переменные вокруг нас</h1>
<div id="--" class="section level2">
<h2>Числа и События</h2>
<p>До сих пор в качестве переменной отклика мы рассматривали числовые данные.</p>
<ul>
<li>Содержание сухого вещества в икре</li>
<li>Вес младенцев</li>
<li>Объем легких</li>
<li>Число посещений цветков опылителями.</li>
</ul>
<p>А как быть, если мы хотим проанализировать связь появления того или иного <strong>события</strong> (произошло или не произошло) с некоторыми предикторами?</p>
</div>
<div id="--" class="section level2">
<h2>События и предикторы</h2>
<p>В зависимости от предикторов события могут происходить чаще или реже – логика, совпадающая с логикой связи количественной переменной отклика с набором предикторов.</p>
<p>Например, по мере роста температуры воздуха летом чаще будут встречаться люди в шортах: событие “встретился человек в шортах” положительно связано с температурой воздуха.</p>
<p>Событие “покупка автомобиля” явно связана с предиктором “количество денег на счете”, однако эта связь может быть совсем непростой.</p>
</div>
<div id="---" class="section level2">
<h2>Бинарные данные вокруг нас</h2>
<p>Бинарные данные – очень распространенный тип зависимых переменных</p>
<ul>
<li>Кто-то в результате лечебных процедур выжил или умер<br />
</li>
<li>Обследованное животное заражено паразитами или здорово<br />
</li>
<li>Футбольная команда выиграла или проиграла<br />
</li>
<li>Блюдо вкусное или невкусное</li>
</ul>
<p>Все эти события могут быть связаны с самыми разными предикторами и эту связь можно описать с помощью регрессионных моделей.</p>
<p>Обобщенные линейные модели позволяют моделировать в том числе и бинарные данные.</p>
</div>
</div>
<div id="----" class="section level1 t">
<h1>Пример – морские звезды и мидии</h1>
<div id="------" class="section level2">
<h2>Различают ли морские звезды два вида мидий?</h2>
<p>Атлантические мидии (<em>Mytilus edulis</em>) коренной для Белого моря вид, но недавно туда вселились мидии другого вида – тихоокеанские мидии (<em>M.trossulus</em>).</p>

<p></p>

<p>Вселенец имеет меньшую промысловую значимость и потенциально может влиять на структуру экосистемы. Важно понять, что регулирует их численность. Наиболее значимый фактор – это морские звезды, питающиеся мидиями.</p>
<ul>
<li>Различают ли морские звезды два вида мидий?</li>
<li>Различают ли хищники мидий разных размеров?</li>
</ul>


</div>
<div id="--" class="section level2">
<h2>Тонкости дизайна эксперимента</h2>
<p>Морских звезд вместе с мидиями двух видов сажали в контейнеры. Через четыре дня совместного существования с хищником регистрировали состояние мидий.</p>

<p></p>

<p>Зависимая переменная:<br />
- <code>Outcome</code> – состояние мидий<br />
(“eaten” – съедена, “not_eaten” – живая )</p>
<p>Предикторы в фокусе исследования:<br />
- <code>Sp</code> – вид мидий (“Ed” – коренной вид, “Tr” – вселенец),<br />
- <code>L</code> – размер мидий (мм).</p>
<p>Чего не хватает?</p>

</div>
<div id="---" class="section level2">
<h2>Как быть с контейнерами?</h2>
<p>В этом эксперименте, помимо интересующих нас дискретного фактора <code>Sp</code> (вид мидии) и непрерывного предиктора <code>L</code> (размер), есть еще один фактор <code>Box</code>.</p>
<p>Этот фактор нас не интересует, но его нельзя не учитывать.</p>
<p>Мы должны включить в модель переменную <code>Box</code> в качестве дискретного фактора с 4 уровнями.</p>
<p>В лекциях, посвященных <strong>смешанным линейным моделям</strong>, мы научим вас, как включать в модель подобные факторы более правильным способом.</p>
</div>
<div id="-" class="section level2">
<h2>Читаем данные</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">astr &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;data/aster_mussel.csv&#39;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">head</span>(astr)</a></code></pre></div>
<pre><code>#   Box    L Sp   Outcome
# 1   1 33.1 Tr not_eaten
# 2   1 24.8 Ed not_eaten
# 3   1 33.0 Ed not_eaten
# 4   1 18.8 Ed not_eaten
# 5   1 34.0 Ed not_eaten
# 6   1 22.6 Ed not_eaten</code></pre>
<p>Номер экспериментального контейнера закодирован числами,<br />
поэтому превращаем его в фактор.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">astr<span class="op">$</span>Box &lt;-<span class="st"> </span><span class="kw">factor</span>(astr<span class="op">$</span>Box)</a></code></pre></div>
</div>
<div id="--" class="section level2">
<h2>Знакомимся с данными</h2>
<p>Нет ли пропущенных значений?</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">colSums</span>(<span class="kw">is.na</span>(astr))</a></code></pre></div>
<pre><code>#     Box       L      Sp Outcome 
#       0       0       0       0</code></pre>
<p>Каковы объемы выборок?</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">table</span>(astr<span class="op">$</span>Box)</a></code></pre></div>
<pre><code># 
#  1  2  3  4 
# 66 68 74 78</code></pre>
</div>
<div id="--" class="section level2">
<h2>Нет ли коллинеарности</h2>

<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw">library</span>(ggplot2); <span class="kw">theme_set</span>(<span class="kw">theme_bw</span>()); <span class="kw">library</span>(cowplot)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"></a>
<a class="sourceLine" id="cb8-3" data-line-number="3">Pl_Sp &lt;-<span class="st"> </span><span class="kw">ggplot</span>(astr, <span class="kw">aes</span>(<span class="dt">x =</span> Sp, <span class="dt">y =</span> L)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">Pl_Box &lt;-<span class="st"> </span><span class="kw">ggplot</span>(astr, <span class="kw">aes</span>(<span class="dt">x =</span> Box, <span class="dt">y =</span> L)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()</a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="kw">plot_grid</span>(Pl_Sp, Pl_Box, <span class="dt">ncol =</span> <span class="dv">2</span>)</a></code></pre></div>
<embed src="14_GLM_binary_new_files/figure-html/unnamed-chunk-6-1.pdf" width="3in" height="1.5in" type="application/pdf" />


<p>Размер распределен более-менее равномерно. Коллинеарности нет.</p>

</div>
<div id="--" class="section level2">
<h2>Есть ли выбросы?</h2>

<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw">ggplot</span>(astr, <span class="kw">aes</span>(<span class="dt">y =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(astr))) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> L) )</a></code></pre></div>
<embed src="14_GLM_binary_new_files/figure-html/unnamed-chunk-7-1.pdf" width="3in" height="1.25in" type="application/pdf" />


<p>Выбросов нет.</p>

</div>
<div id="--" class="section level2">
<h2>Кодирование бинарной переменной</h2>
<p>До сих пор зависимая переменная была числом,<br />
а в данном случае <code>Outcome</code> – это текстовая переменная.</p>
<p>Бинарную переменную надо перекодировать в виде нулей и единиц:</p>
<ul>
<li>1 – мидию съели,<br />
</li>
<li>0 – мидию не съели.</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">astr<span class="op">$</span>Out &lt;-<span class="st"> </span><span class="kw">ifelse</span>(<span class="dt">test =</span> astr<span class="op">$</span>Outcome <span class="op">==</span><span class="st"> &#39;eaten&#39;</span>, <span class="dt">yes =</span> <span class="dv">1</span>,  <span class="dt">no =</span> <span class="dv">0</span>)</a></code></pre></div>
</div>
<div id="----" class="section level2 segue">
<h2>Простой линейной регрессией не обойтись</h2>
<p>В.М. Хайтов, к.б.н.</p>

</div>
<div id="---" class="section level2">
<h2>Что мы хотим построить?</h2>
<p>Наша задача – построить модель, описывающую связь между переменной-откликом (съедена мидия или нет) и тремя предикторами: <code>Sp</code>, <code>L</code> и <code>Box</code></p>
<p>Если бы мы строили GLM с нормальным распределением отклика, то она имела бы следующий вид:</p>
<p><span class="math inline">\(Out_i \sim N(\mu_i, \sigma)\)</span></p>
<p><span class="math inline">\(E(Out_i) = \mu_i\)</span></p>
<p><span class="math inline">\(\mu_i = \eta_i\)</span> – функция связи “идентичность”</p>
<p><span class="math inline">\(\eta_i = b_0 + b_1Sp_{Tr\,i} + b_2L_i + b_3Box_{2\,i}+b_3Box_{3\,i} + Interactions\)</span>,</p>
<p>где <span class="math inline">\(Interactions\)</span> — это все взаимодействия.</p>
</div>
<div id="-" class="section level2">
<h2>Лобовая атака?</h2>
<p>Строим модель по накатанной дороге.</p>
<p>Мы не знаем, взаимодействуют ли дискретные факторы <code>Box</code>, <code>Sp</code> и непрерывный предиктор <code>L</code>.</p>
<p>В полной модели мы должны учесть как влияние самих предикторов, так и влияние их взаимодействия.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">mod_norm &lt;-<span class="st"> </span><span class="kw">glm</span>(Out <span class="op">~</span><span class="st"> </span>Sp <span class="op">*</span><span class="st"> </span>L <span class="op">*</span><span class="st"> </span>Box, <span class="dt">data =</span> astr)</a></code></pre></div>
<p>Все посчиталось…</p>
</div>
<div id="--" class="section level2">
<h2>Посмотрим что получилось</h2>


<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb12-2" data-line-number="2">new_data &lt;-<span class="st"> </span>astr <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(Sp, Box)<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="st">  </span><span class="kw">do</span>(<span class="kw">data.frame</span>(<span class="dt">L =</span> <span class="kw">seq</span>(<span class="kw">min</span>(.<span class="op">$</span>L), <span class="kw">max</span>(.<span class="op">$</span>L), <span class="dt">length.out =</span> <span class="dv">100</span>)))</a>
<a class="sourceLine" id="cb12-4" data-line-number="4">new_data<span class="op">$</span>fit &lt;-<span class="st"> </span><span class="kw">predict</span>(mod_norm, <span class="dt">newdata =</span> new_data) <span class="co"># Предсказанные значения</span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="kw">ggplot</span>(new_data, <span class="kw">aes</span>(<span class="dt">x =</span> L, <span class="dt">y =</span> fit)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> Box)) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>Sp, <span class="dt">ncol =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> astr, <span class="kw">aes</span>(<span class="dt">x =</span> L, <span class="dt">y =</span> Out), <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">color =</span> <span class="st">&#39;blue&#39;</span>)</a></code></pre></div>
<embed src="14_GLM_binary_new_files/figure-html/unnamed-chunk-10-1.pdf" width="3in" height="1.25in" type="application/pdf" />


<p>Во-первых, непонятно, что за величина отложена по оси OY.</p>

</div>
<div id="-" class="section level2">
<h2>Диагностика модели</h2>

<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">mod_norm_diag &lt;-<span class="st"> </span><span class="kw">fortify</span>(mod_norm)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="kw">ggplot</span>(mod_norm_diag, <span class="kw">aes</span>(<span class="dt">x =</span> .fitted, <span class="dt">y =</span> .stdresid)) <span class="op">+</span><span class="st">  </span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>)</a></code></pre></div>
<embed src="14_GLM_binary_new_files/figure-html/unnamed-chunk-11-1.pdf" width="3in" height="1.5in" type="application/pdf" />


<p>Во-втрых, модель предсказывает отрицательные значения.</p>
<p>Простая линейная модель <strong>категорически не годится</strong>!</p>

</div>
<div id="-" class="section level2 segue">
<h2>Логистическая кривая</h2>
<p>В.М. Хайтов, к.б.н.</p>

</div>
<div id="-----" class="section level2">
<h2>Бинарные данные можно представлять и иначе</h2>
<p>Бинарные данные очень неудобны для работы. Вместо того, чтобы моделировать наличие нулей и единиц, мы будем моделировать вероятности получения единиц.</p>
<p>Появляется новое обозначение:</p>
<ul>
<li><span class="math inline">\(\pi_i\)</span> – вероятность события <span class="math inline">\(y_i = 1\)</span> при данных условиях,<br />
</li>
<li><span class="math inline">\(1 - \pi_i\)</span> – вероятность альтернативного события <span class="math inline">\(y_i = 0\)</span>.</li>
</ul>

<p><span class="math inline">\(\pi_i\)</span> – непрерывная величина, варьирующая от 0 до 1.</p>
</div>
<div id="-------" class="section level2">
<h2>Симулированный пример: От дискретных значений к оценкам вероятностей</h2>
<p>От 1 и 0 (слева) можно перейти к <span class="math inline">\(\pi_i\)</span> – оценкам вероятности положительных исходов (справа).</p>
<p>Мы можем проиллюстрировать этот переход, изобразив доли в общем количестве исходов <strong>при данном значении предиктора</strong> <span class="math inline">\(p_{y = 1 | x_i}\)</span> (красные точки). И <span class="math inline">\(\pi\)</span>, и <span class="math inline">\(p_{y = 1 | x_i}\)</span> варьируют от 0 до 1.</p>
<embed src="14_GLM_binary_new_files/figure-html/unnamed-chunk-12-1.pdf" width="4in" height="1.5in" type="application/pdf" />
</div>
<div id="-------" class="section level2">
<h2>Симулированный пример: Можно ли подобрать простую линейную регрессию?</h2>

<embed src="14_GLM_binary_new_files/figure-html/unnamed-chunk-13-1.pdf" width="2.7in" height="1.5in" type="application/pdf" />

<p>Связь зависимой переменной с предиктором можно было бы описать прямой:</p>
<p><span class="math inline">\(\pi_i = \beta_0 + \beta_1x_i\)</span></p>
<p>Но! Вероятность события, может принимать значения только от 0 до 1.<br />
А прямая линия ничем не ограничена и может выходить за пределы интервала [0, 1].</p>

</div>
<div id="---" class="section level2">
<h2>Симулированный пример: Логистическая кривая</h2>

<embed src="14_GLM_binary_new_files/figure-html/unnamed-chunk-14-1.pdf" width="2.7in" height="1.5in" type="application/pdf" />

<p>Связь вероятности положительного исхода и значений предиктора можно описать логистической кривой:</p>
<p><span class="math display">\[ 
\pi_i = \frac{e^{\beta_0 + \beta_1x_i}}{1 + e^{\beta_0 + \beta_1x_i}}
\]</span> Логистическая кривая удобна для описания вероятностей, т.к. ее значения лежат в пределах от 0 до 1.</p>

</div>
<div id="----1" class="section level2">
<h2>Симулированный пример: Логистическая кривая</h2>

<embed src="14_GLM_binary_new_files/figure-html/unnamed-chunk-15-1.pdf" width="2.7in" height="1.5in" type="application/pdf" />

<p>В реальной жизни нам не потребуется даже рассчитывать доли положительных исходов от общего количества.</p>
<p>Благодаря GLM мы сможем оценить вероятности непосредственно по исходным данным.</p>

</div>
<div id="--" class="section level2 segue">
<h2>Шансы и логиты</h2>
<p>В.М. Хайтов, к.б.н.</p>

</div>
<div id="-------" class="section level2">
<h2>Шансы – еще один способ выразить бинарную переменную отклика</h2>
<p>В обыденной речи мы часто используем фразы подобные такой:</p>
<p>“Шансы на победу 1 к 3”: в одном случае выигрыш в трех проигрыш</p>
<p>Шансы – это тоже оценка вероятности события. Шансы показывают сколько в данной системе положительных исходов и сколько отрицательных.</p>
</div>
<div id="-" class="section level2">
<h2>Отношение шансов</h2>
<p>Шансы (odds) часто представляют в виде отношения шансов (odds ratio): <span class="math inline">\(odds=\frac{n_{+}}{n_{-}}\)</span></p>
<p>Если отношение шансов &gt; 1, то вероятность наступления события выше, чем вероятность того, что оно не произойдет. Если отношение шансов &lt; 1, то наоборот.</p>
<p>Если можно оценить вероятность положительного события, то отношение шансов выглядит так : <span class="math inline">\(odds=\frac{\pi}{1-\pi}\)</span></p>
<p>Отношение шансов варьирует от 0 до <span class="math inline">\(+\infty\)</span>.</p>
</div>
<div id="--1" class="section level2">
<h2>Отношение шансов</h2>
<p>Если отношение шансов = 1, то вероятность того, что событие произойдет равно вероятности того, что событие не произойдет.</p>
<p>Асимметрия: отношение шансов от 1 до <span class="math inline">\(+\infty\)</span> говорит о том, что вероятность того, что событие произойдет, выше, чем вероятность того, что оно не произойдет, но если наоборот, то отношение шансов “зажато” между 0 и 1.</p>
</div>
<div class="section level2">
<h2>Логиты</h2>
<p>Отношение шансов можно преобразовать в <em>Логиты</em> (logit):</p>
<p><span class="math display">\[
ln(odds)=ln(\frac{\pi}{1-\pi})
\]</span></p>
<p>Значения логитов – это трансформированные оценки вероятности события.</p>
<p>Логиты варьируют от <span class="math inline">\(-\infty\)</span> до <span class="math inline">\(+\infty\)</span>.</p>
<p>Логиты симметричны относительно 0, т.е. <span class="math inline">\(ln(1)\)</span>.</p>
<p>Для построения моделей в качестве зависимой переменной удобнее брать логиты.</p>
</div>
<div id="------" class="section level2 segue">
<h2>Немного алгебры: Логиты в качестве зависимой переменной</h2>
<p>В.М. Хайтов, к.б.н.</p>

</div>
<div id="------" class="section level2">
<h2>Докажем, что логит преобразование линеаризует логистическую кривую</h2>
<p>Когда предиктор один, логистическая модель принимает такую форму:</p>
<p><span class="math inline">\(\pi = \cfrac{e ^ {\beta_0 + \beta_1 x}}{1 + e^{\beta_0 + \beta_1 x}}\)</span></p>
<p>Обозначим для краткости <span class="math inline">\(\beta_0 + \beta_1 x \equiv z\)</span></p>
<p>Давайте докажем, что логит преобразование <span class="math inline">\(logit(\pi) = ln\Big(\cfrac{\pi}{1 - \pi}\Big)\)</span> сделает логистическую функцию линейной, т.е. что</p>
<p><span class="math inline">\(ln\Big(\cfrac{\pi}{1 - \pi}\Big) = z\)</span></p>
</div>
<div id="---pi---" class="section level2">
<h2>Подставим выражение для <span class="math inline">\(\pi\)</span> в формулу логита</h2>
<p><span class="math inline">\(ln(\frac{\pi}{1-\pi}) = ln(\frac{\frac{e^z}{1+e^z}}{1-\frac{e^z}{1+e^z}})\)</span></p>
<p>Логарифм отношения равен разности логарифмов, тогда:</p>
<p><span class="math inline">\(ln(\frac{e^z}{1+e^z}) - ln({1-\frac{e^z}{1+e^z}})\)</span></p>
<p>Вторую дробь можно упростить:</p>

<p><span class="math inline">\(ln(\frac{e^z}{1+e^z}) - ln({\frac{1+e^z - e^z}{1+e^z}}) = ln(\frac{e^z}{1+e^z}) - ln({\frac{1}{1+e^z}})\)</span></p>
</div>
<div id="-" class="section level2">
<h2>Продолжаем преобразования</h2>
<p><span class="math inline">\(ln(\frac{e^z}{1+e^z}) - ln({\frac{1}{1+e^z}}) = ln(e^z) - ln(1+e^z) - (ln(1) -ln(1+e^z))\)</span></p>

<p><span class="math inline">\(ln(e^z) - ln(1+e^z) - 0 +ln(1+e^z) = ln(e^z) = z\)</span></p>
<p><span class="math inline">\(ln(\frac{\pi(x)}{1-\pi(x)})= z = \beta_0 + \beta_1 x\)</span></p>
<p>Т.е. после логит-преобразования логистическая кривая становится прямой.</p>
</div>
<div id="--link-function" class="section level2">
<h2>Связывающая функция (link function)</h2>
<p><strong>Мы уже знаем</strong>: Для линеаризации связи между предикторами и зависимой переменной применяется связывающая функция.</p>
<p>Функция логит-преобразования <span class="math inline">\(g(E(y))=ln(\frac{\pi}{1-\pi})\)</span> это одна из возможных связывающих функций, применяемых для анализа бинарных переменных отклика.</p>
<p>Другие связывающие функции: probit, cloglog.</p>
</div>
<div id="--" class="section level2">
<h2>Логика математических преобразований</h2>
<ol style="list-style-type: decimal">
<li>От дискретной оценки событий (1 или 0) переходим к оценке вероятностей.</li>
<li>Связь вероятностей с предиктором описывается логистической кривой.</li>
<li>Если при помощи функции связи перейти от вероятностей к логитам, то связь с предиктором будет описываться прямой линией.</li>
<li>Параметры линейной модели для такой прямой можно оценить при помощи линейной модели.</li>
</ol>

<p>Теперь мы готовы сформулировать модель в математическом виде.</p>
</div>
<div id="glm----" class="section level2">
<h2>GLM с биномиальным распределением отклика</h2>
<p><span class="math inline">\(y_i \sim Binomial(n = 1, \pi_i)\)</span></p>
<p><span class="math inline">\(E(y_i) = \pi_i = \cfrac{e ^ {\beta_0 + \beta_1 x_{1} + ... + \beta_{p-1}~x_{p- 1}}}{1 + e^{\beta_0 + \beta_1 x_{1} + ... + \beta_{p-1}~x_{p- 1}}}\)</span></p>
<p><span class="math inline">\(ln(\cfrac{\pi_i}{1 - \pi_i}) = \eta_i\)</span> — функция связи логит, переводит вероятности в логиты.</p>
<p><span class="math inline">\(\eta_i = \beta_0 + \beta_1 x_{1\,i} + ... + \beta_{p-1\,i}~x_{p- 1\,i}\)</span></p>

<p>Чтобы перейти обратно от логитов к вероятностям, применяется логистическое преобразование (это функция, обратная функции связи):</p>
<p><span class="math inline">\(\pi_i = \cfrac{e ^ {\eta_i}}{1 + e^{\eta_i}}\)</span></p>
</div>
<div id="-----" class="section level2 segue">
<h2>Вернемся к морским звездам и мидиям</h2>
<p>В.М. Хайтов, к.б.н.</p>

</div>
<div id="glm-----1" class="section level2">
<h2>GLM с биномиальным распределением отклика</h2>
<p><span class="math inline">\(Out_i \sim Binomial(n = 1, \pi_i)\)</span></p>
<p><span class="math inline">\(E(Out_i) = \pi_i\)</span></p>
<p><span class="math inline">\(ln(\frac{\pi_i}{1 - \pi_i}) = \eta_i\)</span></p>
<p><span class="math inline">\(\pmb{\eta} = \mathbf{X}\pmb{\beta}\)</span></p>
<p>Полная модель в изучаемой системе включает много членов:</p>
<ul>
<li>Главные предикторы: <span class="math inline">\(Sp\)</span>, <span class="math inline">\(L\)</span>, <span class="math inline">\(Box\)</span></li>
<li>Взаимодействия первого порядка: <span class="math inline">\(Sp\)</span>:<span class="math inline">\(L\)</span>, <span class="math inline">\(Sp\)</span>:<span class="math inline">\(Box\)</span>, <span class="math inline">\(L\)</span>:<span class="math inline">\(Box\)</span></li>
<li>Взаимодействия второго порядка: <span class="math inline">\(Sp\)</span>:<span class="math inline">\(L\)</span>:<span class="math inline">\(Box\)</span></li>
</ul>
<!-- $\eta_i = b_0 + b_1Sp_{Tr_i} + b_2L_i + b_3Box_{2_i} + b_3Box_{3_i} + b_4Box_{4_i} + b_5LBox_{2_i} + b_6LBox_{3_i} + b_7LBox_{4_i} + b_8Sp_{Tr_i}Box_{2_i} + b_9Sp_{Tr_i}Box_{3_i} + b_10Sp_{Tr_i}Box_{4_i}$ -->
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">mod &lt;-<span class="st"> </span><span class="kw">glm</span>(Out <span class="op">~</span><span class="st"> </span>Sp<span class="op">*</span>L<span class="op">*</span>Box, <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> <span class="st">&#39;logit&#39;</span>), <span class="dt">data =</span> astr)</a></code></pre></div>
</div>
<div id="----" class="section level2">
<h2>Анализ девиансы для полной модели</h2>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw">library</span>(car)</a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="kw">Anova</span>(mod)</a></code></pre></div>
<pre><code># Analysis of Deviance Table (Type II tests)
# 
# Response: Out
#          LR Chisq Df Pr(&gt;Chisq)    
# Sp           7.28  1    0.00696 ** 
# L           12.35  1    0.00044 ***
# Box          1.06  3    0.78597    
# Sp:L         0.05  1    0.82686    
# Sp:Box       2.57  3    0.46335    
# L:Box        2.06  3    0.56055    
# Sp:L:Box     4.86  3    0.18203    
# ---
# Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Эту модель можно упростить!</p>
</div>
<div id="---1" class="section level2">
<h2>Упрощение модели: Шаг 1</h2>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw">drop1</span>(mod, <span class="dt">test =</span> <span class="st">&#39;Chi&#39;</span>)</a></code></pre></div>
<pre><code># Single term deletions
# 
# Model:
# Out ~ Sp * L * Box
#          Df Deviance AIC  LRT Pr(&gt;Chi)
# &lt;none&gt;           180 212              
# Sp:L:Box  3      185 211 4.86     0.18</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">mod2 &lt;-<span class="st"> </span><span class="kw">update</span>(mod, . <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>Sp<span class="op">:</span>L<span class="op">:</span>Box)</a></code></pre></div>
</div>
<div id="---2" class="section level2">
<h2>Упрощение модели: Шаг 2</h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw">drop1</span>(mod2, <span class="dt">test =</span> <span class="st">&#39;Chi&#39;</span>)</a></code></pre></div>
<pre><code># Single term deletions
# 
# Model:
# Out ~ Sp + L + Box + Sp:L + Sp:Box + L:Box
#        Df Deviance AIC   LRT Pr(&gt;Chi)
# &lt;none&gt;         185 211               
# Sp:L    1      185 209 0.048     0.83
# Sp:Box  3      187 207 2.567     0.46
# L:Box   3      187 207 2.058     0.56</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">mod3 &lt;-<span class="st"> </span><span class="kw">update</span>(mod2, . <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>Sp<span class="op">:</span>L)</a></code></pre></div>
</div>
<div id="---3" class="section level2">
<h2>Упрощение модели: Шаг 3</h2>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="kw">drop1</span>(mod3, <span class="dt">test =</span> <span class="st">&#39;Chi&#39;</span>)</a></code></pre></div>
<pre><code># Single term deletions
# 
# Model:
# Out ~ Sp + L + Box + Sp:Box + L:Box
#        Df Deviance AIC  LRT Pr(&gt;Chi)
# &lt;none&gt;         185 209              
# Sp:Box  3      188 206 2.65     0.45
# L:Box   3      187 205 2.27     0.52</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1">mod4 &lt;-<span class="st"> </span><span class="kw">update</span>(mod3, . <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>L<span class="op">:</span>Box)</a></code></pre></div>
</div>
<div id="---4" class="section level2">
<h2>Упрощение модели: Шаг 4</h2>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="kw">drop1</span>(mod4, <span class="dt">test =</span> <span class="st">&#39;Chi&#39;</span>)</a></code></pre></div>
<pre><code># Single term deletions
# 
# Model:
# Out ~ Sp + L + Box + Sp:Box
#        Df Deviance AIC   LRT Pr(&gt;Chi)    
# &lt;none&gt;         187 205                   
# L       1      200 216 12.35  0.00044 ***
# Sp:Box  3      190 202  3.01  0.39031    
# ---
# Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1">mod5 &lt;-<span class="st"> </span><span class="kw">update</span>(mod4, . <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>Sp<span class="op">:</span>Box)</a></code></pre></div>
</div>
<div id="---5" class="section level2">
<h2>Упрощение модели: Шаг 5</h2>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1"><span class="kw">drop1</span>(mod5, <span class="dt">test =</span> <span class="st">&#39;Chi&#39;</span>)</a></code></pre></div>
<pre><code># Single term deletions
# 
# Model:
# Out ~ Sp + L + Box
#        Df Deviance AIC   LRT Pr(&gt;Chi)    
# &lt;none&gt;         190 202                   
# Sp      1      198 208  7.48  0.00625 ** 
# L       1      202 212 11.81  0.00059 ***
# Box     3      191 197  1.12  0.77165    
# ---
# Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1">mod6 &lt;-<span class="st"> </span><span class="kw">update</span>(mod5, . <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>Box)</a></code></pre></div>
</div>
<div id="---6" class="section level2">
<h2>Упрощение модели: Шаг 6</h2>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="kw">drop1</span>(mod6, <span class="dt">test =</span> <span class="st">&#39;Chi&#39;</span>)</a></code></pre></div>
<pre><code># Single term deletions
# 
# Model:
# Out ~ Sp + L
#        Df Deviance AIC   LRT Pr(&gt;Chi)    
# &lt;none&gt;         191 197                   
# Sp      1      199 203  7.89  0.00496 ** 
# L       1      203 207 11.75  0.00061 ***
# ---
# Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Больше никаких предикторов исключать нельзя: <code>mod6</code> – финальная модель.</p>
</div>
<div id="aic---" class="section level2">
<h2>AIC для финальной модели</h2>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1"><span class="kw">AIC</span>(mod, mod2, mod3, mod4, mod5, mod6)</a></code></pre></div>
<pre><code>#      df AIC
# mod  16 212
# mod2 13 211
# mod3 12 209
# mod4  9 205
# mod5  6 202
# mod6  3 197</code></pre>
<p>Информационный критерий Акайке показывает, что по мере удаления предикторов модель становится лучше.</p>
<p>Финальная модель (<code>mod6</code>) лучше, чем полная модель, с которой мы начинали.</p>
</div>
<div id="-------" class="section level2 segue">
<h2>Смысл коэффициентов в моделях с бинарной переменной отклика</h2>
<p>В.М. Хайтов, к.б.н.</p>

</div>
<div id="----" class="section level2">
<h2>Что за модель мы построили?</h2>


<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1"><span class="kw">summary</span>(mod6)</a></code></pre></div>
<pre><code># 
# Call:
# glm(formula = Out ~ Sp + L, family = binomial(link = &quot;logit&quot;), 
#     data = astr)
# 
# Deviance Residuals: 
#    Min      1Q  Median      3Q     Max  
# -1.058  -0.510  -0.410  -0.289   2.593  
# 
# Coefficients:
#             Estimate Std. Error z value Pr(&gt;|z|)   
# (Intercept)    0.399      0.875    0.46   0.6483   
# SpTr           1.070      0.379    2.82   0.0047 **
# L             -0.113      0.035   -3.24   0.0012 **
# ---
# Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
# 
# (Dispersion parameter for binomial family taken to be 1)
# 
#     Null deviance: 212.58  on 285  degrees of freedom
# Residual deviance: 191.24  on 283  degrees of freedom
# AIC: 197.2
# 
# Number of Fisher Scoring iterations: 5</code></pre>

<p><span class="math inline">\(Out_i \sim Binomial(n = 1, \pi)\)</span></p>
<p><span class="math inline">\(E(Out_i) = \pi_i\)</span></p>
<p><span class="math inline">\(ln(\frac{\pi_i}{1 - \pi_i}) = \eta_i\)</span></p>
<p><span class="math inline">\(\eta_i = 0.399 + 1.07 Sp_{\,Tr\,i} -0.113 L_i\)</span></p>

</div>
<div id="---" class="section level2">
<h2>Что означают коэффициенты модели?</h2>
<p><span class="math inline">\(Out_i \sim Binomial(n = 1, \pi)\)</span></p>
<p><span class="math inline">\(E(Out_i) = \pi_i\)</span></p>
<p><span class="math inline">\(ln(\frac{\pi_i}{1 - \pi_i}) = \eta_i\)</span></p>
<p><span class="math inline">\(\eta_i = 0.399 + 1.07 Sp_{\,Tr\,i} -0.113 L_i\)</span></p>

<ul>
<li><span class="math inline">\(b_0\)</span> – интерсепт, логарифм отношения шансов для базового уровня дискретного фактора.</li>
<li><span class="math inline">\(b_1\)</span> – <strong>на сколько единиц изменяется логарифм отношения шансов</strong> (logit) для данного уровня (<code>Tr</code>) дискретного фактора <code>Sp</code> по сравнению с базовым уровнем (<code>Ed</code>).</li>
<li><span class="math inline">\(b_2\)</span> – <strong>на сколько единиц изменяется логарифм отношения шансов</strong> (logit), если значение предиктора (<code>L</code>) изменяется на единицу.</li>
</ul>
</div>
<div id="-----" class="section level2">
<h2>Немного алгебры для понимания сути коэффициентов</h2>
<p>Предположим, что у нас в модели есть только один непрерывный предиктор <span class="math inline">\(x\)</span>.</p>
<p>Посмотрим, как изменится предсказанные моделью значения, если значение непрерывного предиктора изменится на 1.</p>
<p>Мы знаем, что в терминах логитов модель выглядит вот так:</p>
<p><span class="math inline">\(\eta = ln(\frac{\pi}{1 - \pi}) = ln(odds)\)</span></p>
<p>Тогда разница между значениями <span class="math inline">\(\eta\)</span> для <span class="math inline">\(x+1\)</span> и <span class="math inline">\(x\)</span> – это логарифм соотношения шансов при этих значениях предиктора:</p>
<p><span class="math inline">\(\eta_{x+1} - \eta_{x} = ln(odds_{x+1}) - ln(odds_x) = ln(\frac{odds_{x+1}}{odds_x})\)</span></p>
</div>
<div id="-" class="section level2">
<h2>Продолжим преобразования</h2>
<p><span class="math inline">\(ln(\frac{odds_{x+1}}{odds_x}) = b_0 + b_1(x+1) - b_0 - b_1x = b_1\)</span></p>
<p><span class="math inline">\(ln(\frac{odds_{x+1}}{odds_x}) = b_1\)</span></p>
<p><span class="math inline">\(\frac{odds_{x+1}}{odds_x} = e^{b_1}\)</span></p>
<p>Полученная величина <span class="math inline">\(e^{b_1}\)</span> показывает, <strong>во сколько раз изменится отношение шансов</strong> при увеличении предиктора на единицу.</p>
<p>Для дискретных факторов <span class="math inline">\(e^{b_1}\)</span> покажет, во сколько раз различается отношение шансов для данного уровня по сравнению с базовым.</p>
</div>
<div id="--" class="section level2">
<h2>Геометрическая интерпретация коэффициентов</h2>
<embed src="14_GLM_binary_new_files/figure-html/unnamed-chunk-31-1.pdf" width="5in" height="2.5in" type="application/pdf" />
</div>
<div id="--b_0" class="section level2">
<h2>Смысл интерсепта <span class="math inline">\(b_0\)</span></h2>
<p>Величина <span class="math inline">\(e^{b_0}\)</span> показывает отношение шансов для события, когда все предикторы равны нулю.</p>
<p>Когда предикторы физически не могут принимать нулевые значения, у этой величины нет смысла.</p>
<p>Но если произведена стандартизация предикторов, то смысл появится. У стандартизованных величин среднее значение равно нулю. Поэтому <span class="math inline">\(e^{b_0}\)</span> покажет соотношение шансов для события при средних значениях предикторов.</p>
</div>
<div id="--" class="section level2">
<h2>Трактуем коэффициенты модели</h2>
<p><span class="math inline">\(\eta_i = 0.399 + 1.07I_{Tr,i} -0.113L_i\)</span></p>

<ul>
<li><p>При увеличении длины тела мидии на 1 мм отношения шансов быть съеденной увеличатся в <span class="math inline">\(e^{-0.113}\)</span> = 0.893 раза. То есть мидия, имеющая больший размер, имеет меньше шансов быть съеденной (больше шансов на выживание)</p></li>
<li><p>Отношение шансов быть съеденной у мидии, относящиеся к группе <code>Tr</code> дискретного фактора <code>Sp</code>, в <span class="math inline">\(e^{1.07}\)</span> = 2.915 раза выше, чем у мидии относящейся к базовому уровню (<code>Ed</code>). То есть вероятность выжить у мидии из группы <code>Tr</code> меньше, чем у мидии из группы <code>Ed</code>.</p></li>
</ul>
</div>
<div id="----" class="section level2 segue">
<h2>Диагностика модели с бинарным откликом</h2>
<p>В.М. Хайтов, к.б.н.</p>

</div>
<div id="--glm----" class="section level2">
<h2>Условия применимости GLM с бинарной переменной-откликом</h2>
<ul>
<li>Случайность и независимость наблюдений.</li>
<li>Линейность связи переменной отклика с предиктором (с учетом связывающей функции).</li>
<li>Отсутствие сверхдисперсии (форма связи среднего с дисперсией должна быть как у величины с биномиальным распределением).</li>
<li>Отсутствие коллинеарности предикторов.</li>
</ul>
</div>
<div id="-" class="section level2">
<h2>Линейность связи</h2>

<p>Мы должны выяснить, нет ли криволинейного паттерна в остатках. Самый простой способ – это построить график остатков от предсказанных значений и наложить на него сглаживающую функцию, подобранную методом loess.</p>


<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1">mod6_diag &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">.fitted =</span> <span class="kw">predict</span>(mod6, <span class="dt">type =</span> <span class="st">&#39;response&#39;</span>),</a>
<a class="sourceLine" id="cb38-2" data-line-number="2">                         <span class="dt">.resid_p =</span> <span class="kw">resid</span>(mod6, <span class="dt">type =</span> <span class="st">&#39;pearson&#39;</span>))</a>
<a class="sourceLine" id="cb38-3" data-line-number="3"><span class="kw">ggplot</span>(mod6_diag, <span class="kw">aes</span>(<span class="dt">y =</span> .resid_p, <span class="dt">x =</span> .fitted)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb38-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>) <span class="op">+</span><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&#39;loess&#39;</span>)</a></code></pre></div>
<embed src="14_GLM_binary_new_files/figure-html/unnamed-chunk-32-1.pdf" width="3in" height="1.3in" type="application/pdf" />


<p>Явного криволинейного паттерна нет.</p>

</div>
<div id="--" class="section level2">
<h2>Проверка на сверхдисперсию</h2>
<p>Важное свойство биномиального распределения – это зависимость между матожиданием и дисперсией.</p>
<p>Мат.ожидание – <span class="math inline">\(E(y_i) = \pi_i\)</span><br />
Дисперсия – <span class="math inline">\(var(y_i) = \pi_i (1-\pi_i)\)</span></p>
<p>То есть в распределении остатков не должно наблюдаться сверхдисперсии (overdispersion).</p>
</div>
<div id="----" class="section level2">
<h2>Еще раз смотрим на результаты</h2>

<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1"><span class="kw">summary</span>(mod6)</a></code></pre></div>
<pre><code>Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)    0.399      0.875    0.46   0.6483   
SpTr           1.070      0.379    2.82   0.0047 **
L             -0.113      0.035   -3.24   0.0012 **
--
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 212.58  on 285  degrees of freedom
Residual deviance: 191.24  on 283  degrees of freedom
AIC: 197.2

Number of Fisher Scoring iterations: 5
</code></pre>
<p>Важная строчка</p>
<pre><code>(Dispersion parameter for binomial family taken to be 1)</code></pre>
</div>
<div id="---1" class="section level2">
<h2>Проверка на сверхдисперсию</h2>

<p>Используем предложенную Беном Болкером функцию проверки на сверхдисперсию,</p>


<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1"><span class="co"># Функция для проверки наличия сверхдисперсии в модели (автор Ben Bolker)</span></a>
<a class="sourceLine" id="cb42-2" data-line-number="2"><span class="co"># http://bbolker.github.io/mixedmodels-misc/glmmFAQ.html</span></a>
<a class="sourceLine" id="cb42-3" data-line-number="3">overdisp_fun &lt;-<span class="st"> </span><span class="cf">function</span>(model) {</a>
<a class="sourceLine" id="cb42-4" data-line-number="4">    rdf &lt;-<span class="st"> </span><span class="kw">df.residual</span>(model)  <span class="co"># Число степеней свободы N - p</span></a>
<a class="sourceLine" id="cb42-5" data-line-number="5">    rp &lt;-<span class="st"> </span><span class="kw">residuals</span>(model,<span class="dt">type=</span><span class="st">&#39;pearson&#39;</span>) <span class="co"># Пирсоновские остатки</span></a>
<a class="sourceLine" id="cb42-6" data-line-number="6">    Pearson.chisq &lt;-<span class="st"> </span><span class="kw">sum</span>(rp<span class="op">^</span><span class="dv">2</span>) <span class="co"># Сумма квадратов остатков, подчиняется Хи-квадрат распределению </span></a>
<a class="sourceLine" id="cb42-7" data-line-number="7">    prat &lt;-<span class="st"> </span>Pearson.chisq<span class="op">/</span>rdf  <span class="co"># Отношение суммы квадратов остатков к числу степеней свободы</span></a>
<a class="sourceLine" id="cb42-8" data-line-number="8">    pval &lt;-<span class="st"> </span><span class="kw">pchisq</span>(Pearson.chisq, <span class="dt">df=</span>rdf, <span class="dt">lower.tail=</span><span class="ot">FALSE</span>) <span class="co"># Уровень значимости</span></a>
<a class="sourceLine" id="cb42-9" data-line-number="9">    <span class="kw">c</span>(<span class="dt">chisq=</span>Pearson.chisq,<span class="dt">ratio=</span>prat,<span class="dt">rdf=</span>rdf,<span class="dt">p=</span>pval)        <span class="co"># Вывод результатов</span></a>
<a class="sourceLine" id="cb42-10" data-line-number="10">}</a>
<a class="sourceLine" id="cb42-11" data-line-number="11"></a>
<a class="sourceLine" id="cb42-12" data-line-number="12"><span class="kw">overdisp_fun</span>(mod6)</a></code></pre></div>
<pre><code>#  chisq  ratio    rdf      p 
# 294.25   1.04 283.00   0.31</code></pre>


<p>Избыточной дисперсии<br />
не выявлено.</p>


<p>Ben Bolker’s glmmFAQ<br />
</p>
</div>
<div id="-" class="section level2 segue">
<h2>Визуализация модели</h2>
<p>В.М. Хайтов, к.б.н.</p>

</div>
<div id="--" class="section level2">
<h2>Данные для предсказаний</h2>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb44-2" data-line-number="2">new_data &lt;-<span class="st"> </span>astr <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(Sp)<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb44-3" data-line-number="3"><span class="st">  </span><span class="kw">do</span>(<span class="kw">data.frame</span>(<span class="dt">L =</span> <span class="kw">seq</span>(<span class="kw">min</span>(.<span class="op">$</span>L), <span class="kw">max</span>(.<span class="op">$</span>L), <span class="dt">length.out =</span> <span class="dv">100</span>)))</a></code></pre></div>
<p>Давайте получим предсказания двумя способами:</p>
<ul>
<li>при помощи операций с матрицами,<br />
чтобы своими глазами увидеть работу функции связи,</li>
<li>при помощи функции <code>predict()</code>.</li>
</ul>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1">?predict.glm</a></code></pre></div>
</div>
<div id="------" class="section level2">
<h2>Предсказания модели при помощи операций с матрицами</h2>

<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1"><span class="co"># Модельная матрица и коэффициенты</span></a>
<a class="sourceLine" id="cb46-2" data-line-number="2">X &lt;-<span class="st"> </span><span class="kw">model.matrix</span>(<span class="op">~</span><span class="st"> </span>Sp <span class="op">+</span><span class="st"> </span>L, <span class="dt">data =</span>  new_data)</a>
<a class="sourceLine" id="cb46-3" data-line-number="3">b &lt;-<span class="st"> </span><span class="kw">coef</span>(mod6)</a>
<a class="sourceLine" id="cb46-4" data-line-number="4"><span class="co"># Предсказанные значения и стандартные ошибки...</span></a>
<a class="sourceLine" id="cb46-5" data-line-number="5"><span class="co"># ...в масштабе функции связи (логит)</span></a>
<a class="sourceLine" id="cb46-6" data-line-number="6">new_data<span class="op">$</span>fit_eta &lt;-<span class="st"> </span>X <span class="op">%*%</span><span class="st"> </span>b       </a>
<a class="sourceLine" id="cb46-7" data-line-number="7">new_data<span class="op">$</span>se_eta &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">diag</span>(X <span class="op">%*%</span><span class="st"> </span><span class="kw">vcov</span>(mod6) <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(X)))</a>
<a class="sourceLine" id="cb46-8" data-line-number="8"><span class="co"># ...в масштабе отклика (применяем функцию, обратную функции связи)</span></a>
<a class="sourceLine" id="cb46-9" data-line-number="9">logit_back &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">exp</span>(x)<span class="op">/</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(x)) <span class="co"># обратная логит-трансформация</span></a>
<a class="sourceLine" id="cb46-10" data-line-number="10">new_data<span class="op">$</span>fit_pi &lt;-<span class="st"> </span><span class="kw">logit_back</span>(new_data<span class="op">$</span>fit_eta)</a>
<a class="sourceLine" id="cb46-11" data-line-number="11">new_data<span class="op">$</span>lwr &lt;-<span class="st"> </span><span class="kw">logit_back</span>(new_data<span class="op">$</span>fit_eta <span class="op">-</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>new_data<span class="op">$</span>se_eta)</a>
<a class="sourceLine" id="cb46-12" data-line-number="12">new_data<span class="op">$</span>upr &lt;-<span class="st"> </span><span class="kw">logit_back</span>(new_data<span class="op">$</span>fit_eta <span class="op">-</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>new_data<span class="op">$</span>se_eta)</a>
<a class="sourceLine" id="cb46-13" data-line-number="13"></a>
<a class="sourceLine" id="cb46-14" data-line-number="14"><span class="kw">head</span>(new_data, <span class="dv">2</span>)</a></code></pre></div>
<pre><code># # A tibble: 2 x 7
# # Groups:   Sp [1]
#   Sp        L fit_eta se_eta fit_pi    lwr    upr
#   &lt;fct&gt; &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
# 1 Ed     16.3   -1.45  0.374  0.190 0.100  0.100 
# 2 Ed     16.5   -1.47  0.368  0.187 0.0990 0.0990</code></pre>
</div>
<div id="---" class="section level2">
<h2>Визуализация в шкале логитов</h2>

<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1">predicted &lt;-<span class="st"> </span><span class="kw">predict</span>(mod6, <span class="dt">newdata =</span> new_data, <span class="dt">se.fit =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb48-2" data-line-number="2">new_data<span class="op">$</span>fit_eta &lt;-<span class="st"> </span>predicted<span class="op">$</span>fit</a>
<a class="sourceLine" id="cb48-3" data-line-number="3">new_data<span class="op">$</span>se_eta &lt;-<span class="st"> </span>predicted<span class="op">$</span>se.fit</a>
<a class="sourceLine" id="cb48-4" data-line-number="4"></a>
<a class="sourceLine" id="cb48-5" data-line-number="5"><span class="kw">ggplot</span>(new_data, <span class="kw">aes</span>(<span class="dt">x =</span> L, <span class="dt">y =</span> fit_eta, <span class="dt">fill =</span> Sp)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb48-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> fit_eta <span class="op">-</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>se_eta, <span class="dt">ymax =</span> fit_eta <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>se_eta), <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb48-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> Sp))</a></code></pre></div>
<embed src="14_GLM_binary_new_files/figure-html/unnamed-chunk-38-1.pdf" width="3in" height="1.4in" type="application/pdf" />


<p>Визуализация проведена для логитов, поэтому зависимость линейная, но по оси <code>OY</code> отложены значения от <span class="math inline">\(-\infty\)</span> до <span class="math inline">\(+\infty\)</span>.</p>

</div>
<div id="-----" class="section level2">
<h2>Визуализация в шкале вероятностей интуитивно понятнее</h2>


<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" data-line-number="1">predicted &lt;-<span class="st"> </span><span class="kw">predict</span>(mod6, <span class="dt">newdata =</span> new_data, <span class="dt">se.fit =</span> <span class="ot">TRUE</span>, <span class="dt">type =</span> <span class="st">&#39;response&#39;</span>)</a>
<a class="sourceLine" id="cb49-2" data-line-number="2">new_data<span class="op">$</span>fit_pi &lt;-<span class="st"> </span>predicted<span class="op">$</span>fit</a>
<a class="sourceLine" id="cb49-3" data-line-number="3">new_data<span class="op">$</span>se_pi &lt;-<span class="st"> </span>predicted<span class="op">$</span>se.fit</a>
<a class="sourceLine" id="cb49-4" data-line-number="4"><span class="kw">ggplot</span>(new_data, <span class="kw">aes</span>(<span class="dt">x =</span> L, <span class="dt">y =</span> fit_pi, <span class="dt">fill =</span> Sp)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb49-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> fit_pi <span class="op">-</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>se_pi, <span class="dt">ymax =</span> fit_pi <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>se_pi), <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb49-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> Sp)) <span class="op">+</span></a>
<a class="sourceLine" id="cb49-7" data-line-number="7"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y=</span><span class="st">&#39;Вероятность&#39;</span>, <span class="dt">title =</span> <span class="st">&#39;Вероятность быть съеденной&#39;</span>)</a></code></pre></div>
<embed src="14_GLM_binary_new_files/figure-html/unnamed-chunk-39-1.pdf" width="3in" height="1.4in" type="application/pdf" />


</div>
<div id="---" class="section level2">
<h2>О чем говорит модель</h2>
<p>Чем больше размер мидии, тем меньше вероятность быть съеденной.</p>
<p>Линия, соответствующая <code>Tr</code>, лежит выше линии <code>Ed</code>. Вероятность быть атакованной у <code>Tr</code> выше.</p>
<p>Значит звезды различают два вида мидий и размер жертвы для них имеет значение.</p>
<embed src="14_GLM_binary_new_files/figure-html/unnamed-chunk-40-1.pdf" width="3in" height="1.4in" type="application/pdf" />
</div>
<div id="take-home-messages" class="section level2 segue">
<h2>## Take-home messages</h2>
<p>В.М. Хайтов, к.б.н.</p>

</div>
<div id="-----" class="section level2">
<h2>Что мы знаем о бинарных переменных</h2>
<ul>
<li>Бинарные переменные-отклики могут обозначаться как угодно (+ или -; Да или Нет).</li>
<li>Удобно кодировать бинарные переменные числами: 1 (событие произошло) или 0 (событие не произошло).</li>
<li>Вместо бинарных обозначений в анализе используются непрерывные оценки вероятности.</li>
<li>Вероятности можно перевести в отношения шансов.</li>
<li>Отношения шансов заменяются логитами.</li>
</ul>
</div>
<div id="----glm----" class="section level2">
<h2>Что мы знаем о GLM с бинарной переменной-откликом</h2>
<ul>
<li>GLM с бинарной переменной-откликом называют логистической регрессией.<br />
</li>
<li>Параметры логистической регрессии подбираются методом максимального правдоподобия.</li>
<li>Угловые коэффициенты логистической регрессии говорят о том, во сколько раз изменяется соотношение шансов для события при увеличении предиктора на единицу (или при переходе от базового уровня фактора к данному уровню).<br />
</li>
<li>Оценить статистическую значимость модели можно с помощью анализа девиансы.</li>
<li>Для визуализации результатов лучше проводить обратное логит-преобразование и изображать логистические кривые.</li>
</ul>
</div>
<div id="-" class="section level2">
<h2>Что почитать</h2>
<ul>
<li>Кабаков Р.И. R в действии. Анализ и визуализация данных на языке R. М.: ДМК Пресс, 2014.</li>
<li>Quinn G.P., Keough M.J. (2002) Experimental design and data analysis for biologists, pp. 92-98, 111-130</li>
<li>Zuur, A.F. et al. 2009. Mixed effects models and extensions in ecology with R. - Statistics for biology and health. Springer, New York, NY.</li>
</ul>
</div>
</div>

<p><small>
<!--
<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a><br /><span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">linmodr</span> by <a xmlns:cc="http://creativecommons.org/ns#" href="varmara.github.io/linmodr/" property="cc:attributionName" rel="cc:attributionURL">Marina Varfolomeeva, Vadim Khaitov, and Yuta tamberg</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
-->
</small></p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
